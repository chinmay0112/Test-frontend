<div class="min-h-screen bg-slate-100 flex items-center justify-center p-4">
  <div class="w-full max-w-5xl bg-white rounded-2xl shadow-xl flex overflow-hidden h-[700px]">
    <!-- Left Side: Image Panel (hidden on small screens) -->
    <div class="hidden lg:flex w-1/2 bg-indigo-600 p-12 flex-col justify-between">
      <div>
        <h1 class="text-white font-bold text-3xl">PrepMaster</h1>
        <p class="text-indigo-200 mt-4 max-w-md">
          Unlock your potential. Ace your exams with our tailored test series and detailed analysis.
        </p>
      </div>
      <div class="mt-8">
        <img
          src="https://placehold.co/400x300/FFFFFF/4F46E5?text=Illustration"
          alt="Learning Illustration"
          class="w-full h-auto rounded-lg"
        />
      </div>
    </div>

    <!-- Right Side: Form Panel -->
    <div class="w-full lg:w-1/2 p-8 sm:p-12 relative">
      @if(isLoading){
      <div
        class="absolute inset-0 bg-white/70 backdrop-blur-sm flex items-center justify-center z-10 rounded-r-2xl"
      >
        <!-- This is your p-progress-spinner, now perfectly centered -->
        <p-progress-spinner
          strokeWidth="8"
          fill="transparent"
          animationDuration=".5s"
          [style]="{ width: '50px', height: '50px' }"
        />
      </div>
      }
      <h2 class="text-3xl font-bold text-slate-800 mb-2">Welcome Back!</h2>
      <p class="text-slate-500 mb-6">Please choose your login method.</p>

      <!-- Login Mode Switcher -->
      <div class="flex border border-slate-300 rounded-lg p-1 mb-8 bg-slate-100">
        <button
          (click)="setLoginMode('email')"
          [ngClass]="
            loginMode === 'email'
              ? 'bg-white shadow text-indigo-700'
              : 'text-slate-500 hover:bg-slate-200'
          "
          class="flex-1 py-2 px-4 rounded-md font-medium text-sm transition-all duration-200"
        >
          Email & Password
        </button>
        <button
          (click)="setLoginMode('phone')"
          [ngClass]="
            loginMode === 'phone'
              ? 'bg-white shadow text-indigo-700'
              : 'text-slate-500 hover:bg-slate-200'
          "
          class="flex-1 py-2 px-4 rounded-md font-medium text-sm transition-all duration-200"
        >
          Phone & OTP
        </button>
      </div>

      <!-- Form: Changes based on loginMode -->
      <!-- Login mode using email -->
      @if(loginMode === 'email'){
      <form [formGroup]="loginFormUsingEmail" (ngSubmit)="onSubmitusingEmail()">
        @if (loginError) {
        <div
          class="bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded-lg relative mb-4"
          role="alert"
        >
          <span class="block sm:inline">{{ loginError }}</span>
        </div>
        }
        <!-- EMAIL / PASSWORD MODE -->
        <div>
          <!-- Email Input -->
          <div class="mb-6 relative">
            <label for="email" class="block text-sm font-medium text-slate-600 mb-2">Email</label>
            <div class="relative">
              <span class="absolute inset-y-0 left-0 flex items-center pl-3">
                <svg
                  class="w-5 h-5 text-slate-400"
                  fill="none"
                  stroke="currentColor"
                  viewBox="0 0 24 24"
                >
                  <path
                    stroke-linecap="round"
                    stroke-linejoin="round"
                    stroke-width="2"
                    d="M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"
                  ></path>
                </svg>
              </span>
              <input
                type="email"
                id="email"
                formControlName="email"
                class="w-full pl-10 pr-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 outline-none transition duration-150"
                placeholder="you@example.com"
              />
            </div>
          </div>

          <!-- Password Input -->
          <div class="mb-6">
            <div class="flex justify-between items-center mb-2">
              <label for="password" class="block text-sm font-medium text-slate-600"
                >Password</label
              >
              <a routerLink="/forgot-password" class="text-sm text-indigo-600 hover:underline"
                >Forgot password?</a
              >
            </div>
            <div class="relative">
              <span class="absolute inset-y-0 left-0 flex items-center pl-3">
                <svg
                  class="w-5 h-5 text-slate-400"
                  fill="none"
                  stroke="currentColor"
                  viewBox="0 0 24 24"
                >
                  <path
                    stroke-linecap="round"
                    stroke-linejoin="round"
                    stroke-width="2"
                    d="M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"
                  ></path>
                </svg>
              </span>
              <input
                type="password"
                id="password"
                formControlName="password"
                class="w-full pl-10 pr-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 outline-none transition duration-150"
                placeholder="••••••••"
              />
            </div>
          </div>
        </div>
        <button
          type="submit"
          [disabled]="!loginFormUsingEmail.valid"
          class="w-full bg-indigo-600 text-white font-semibold py-3 rounded-lg hover:bg-indigo-700 disabled:bg-indigo-300 transition-colors duration-200 mt-4"
        >
          Sign In
        </button>
      </form>
      }

      <!-- Login mode using phone -->
      @if (loginMode === 'phone') {
      <form [formGroup]="loginFormUsingPhone">
        <!-- PHONE / OTP MODE -->

        <div>
          <!-- Phone Input -->
          <div class="mb-6 relative">
            <label for="phone" class="block text-sm font-medium text-slate-600 mb-2"
              >Phone Number</label
            >
            <div class="relative flex items-center">
              <span class="absolute inset-y-0 left-0 flex items-center pl-3 text-slate-500"
                >+91</span
              >
              <input
                type="tel"
                id="phone"
                formControlName="phone"
                class="w-full pl-10 pr-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 outline-none transition duration-150"
                placeholder="9876543210"
                maxlength="10"
              />
              <button
                type="button"
                (click)="sendOtp()"
                [disabled]="otpSent || loginFormUsingPhone.controls['phone'].invalid"
                class="ml-2 px-4 py-2 text-sm font-medium rounded-lg whitespace-nowrap"
                [ngClass]="
                  otpSent
                    ? 'bg-slate-200 text-slate-500 cursor-not-allowed'
                    : 'bg-indigo-100 text-indigo-700 hover:bg-indigo-200'
                "
              >
                {{ otpSent ? 'OTP Sent' : 'Send OTP' }}
              </button>
            </div>
          </div>

          <!-- OTP Input -->
          <div class="mb-6 relative" *ngIf="otpSent">
            <label for="otp" class="block text-sm font-medium text-slate-600 mb-2">Enter OTP</label>
            <div class="relative">
              <input
                type="text"
                id="otp"
                formControlName="otp"
                class="w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 outline-none transition duration-150 tracking-widest text-center"
                placeholder="------"
                maxlength="6"
              />
            </div>
          </div>
        </div>

        <!-- Sign In Button for phone -->
        <button
          type="submit"
          [disabled]="!loginFormUsingPhone.valid"
          class="w-full bg-indigo-600 text-white font-semibold py-3 rounded-lg hover:bg-indigo-700 disabled:bg-indigo-300 transition-colors duration-200 mt-4"
        >
          Sign In
        </button>
      </form>
      }

      <!-- Divider & Google Sign In (Common to both modes) -->
      <div class="my-8 flex items-center">
        <div class="flex-grow border-t border-slate-300"></div>
        <span class="mx-4 text-xs text-slate-400 font-medium">OR</span>
        <div class="flex-grow border-t border-slate-300"></div>
      </div>

      <button
        class="w-full flex items-center justify-center py-3 border border-slate-300 rounded-lg hover:bg-slate-50 transition-colors duration-200"
      >
        <svg class="w-5 h-5 mr-3" viewBox="0 0 48 48">
          <!-- Google Icon SVG -->
          <path
            fill="#FFC107"
            d="M43.611,20.083H42V20H24v8h11.303c-1.649,4.657-6.08,8-11.303,8c-6.627,0-12-5.373-12-12c0-6.627,5.373-12,12-12c3.059,0,5.842,1.154,7.961,3.039l5.657-5.657C34.046,6.053,29.268,4,24,4C12.955,4,4,12.955,4,24c0,11.045,8.955,20,20,20c11.045,0,20-8.955,20-20C44,22.659,43.862,21.35,43.611,20.083z"
          ></path>
          <path
            fill="#FF3D00"
            d="M6.306,14.691l6.571,4.819C14.655,15.108,18.961,12,24,12c3.059,0,5.842,1.154,7.961,3.039l5.657-5.657C34.046,6.053,29.268,4,24,4C16.318,4,9.656,8.337,6.306,14.691z"
          ></path>
          <path
            fill="#4CAF50"
            d="M24,44c5.166,0,9.86-1.977,13.409-5.192l-6.19-5.238C29.211,35.091,26.715,36,24,36c-5.202,0-9.619-3.317-11.283-7.946l-6.522,5.025C9.505,39.556,16.227,44,24,44z"
          ></path>
          <path
            fill="#1976D2"
            d="M43.611,20.083H42V20H24v8h11.303c-0.792,2.237-2.231,4.166-4.087,5.574l6.19,5.238C39.99,36.958,44,31.25,44,24C44,22.659,43.862,21.35,43.611,20.083z"
          ></path>
        </svg>
        <span class="text-sm font-medium text-slate-700">Sign in with Google</span>
      </button>

      <p class="text-center text-sm text-slate-500 mt-8">
        Don't have an account?
        <a routerLink="/register" class="font-semibold text-indigo-600 hover:underline">Sign up</a>
      </p>
    </div>
  </div>
</div>
